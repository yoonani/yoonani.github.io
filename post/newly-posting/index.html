<!DOCTYPE html>
<html lang="en"><meta charset="utf-8"><meta name="generator" content="Hugo 0.73.0" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><title>Excel로 저장된 주민등록 인구수를 R로 읽어 tidy 데이터로 변환하기&nbsp;&ndash;&nbsp;Data blog</title><link rel="stylesheet" href="/css/core.min.ab321a2ad61315bebb72e6e3fa1108c4e8ffe4eada5cf5f20131d183a523496246d761df8fc832549be5b9dd47c40509.css" integrity="sha384-qzIaKtYTFb67cubj&#43;hEIxOj/5OraXPXyATHRg6UjSWJG12Hfj8gyVJvlud1HxAUJ"><meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Excel로 저장된 주민등록 인구수를 R로 읽어 tidy 데이터로 변환하기" /><body><section id="header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/"><span class="site name">Data blog</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/categories/">Categories</a><a class="nav item" href="/tags/">Tags</a></nav></div></span></div><div class="site slogan"><span class="title">yoonani @ Culture Lab</span></div></section><section id="content"><div class="article-container"><section class="article header">
    <h1 class="article title">Excel로 저장된 주민등록 인구수를 R로 읽어 tidy 데이터로 변환하기</h1><p class="article date">2020-06-24</p></section><article class="article markdown-body">

<div id="TOC">
<ul>
<li><a href="#데이터-얻기">데이터 얻기</a><ul>
<li><a href="#주민등록-인구">주민등록 인구</a></li>
<li><a href="#데이터-읽기">데이터 읽기</a></li>
<li><a href="#열-이름-재지정하기">열 이름 재지정하기</a></li>
<li><a href="#데이터-다시-읽기">데이터 다시 읽기</a></li>
<li><a href="#변수명-재정의하기">변수명 재정의하기</a></li>
</ul></li>
<li><a href="#tidy-데이터로-변환하기기">tidy 데이터로 변환하기기</a><ul>
<li><a href="#wide2long">wide2long</a></li>
<li><a href="#필요한-열-생성하기">필요한 열 생성하기</a></li>
</ul></li>
</ul>
</div>

<p>춘천시의 읍면동별 인구현황과 함께 어떤 변화가 있었는지 알아보고자 한다.</p>
<div id="데이터-얻기" class="section level2">
<h2>데이터 얻기</h2>
<div id="주민등록-인구" class="section level3">
<h3>주민등록 인구</h3>
<ul>
<li><a href="https://www.chuncheon.go.kr/board/list.chuncheon?boardId=BBS_0000294&amp;menuCd=DOM_000000505006002000&amp;contentsSid=1889&amp;cpath=">춘천시 주민등록인구 현황</a></li>
<li><a href="http://27.101.213.4">행정안전부 주민등록인구통계</a></li>
</ul>
<p>위의 링크 중 행정안전부 주민등록인구통계를 통해 춘천의 읍면동별 년간 인구와 읍면동별 년간 5세단위 자료를 구하였고 이를 통해 무언가를 좀 찾아보고자 한다. 다음은 행정안전부에서 제공하는 자료에 대한 간략한 설명이다.</p>
<ul>
<li>주민등록 인구와 세대수와 연령별 인구현황을 별도의 메뉴로 제공하고 있으며, 행정구역, 조회기간 등을 사용자로 부터 입력받아 해당 자료의 크기에 따라 기간별 제한이 있다.</li>
<li>제공하는 파일은 csv와 Excel 두 유형이다.</li>
</ul>
</div>
<div id="데이터-읽기" class="section level3">
<h3>데이터 읽기</h3>
<pre class="r"><code>dat1 &lt;- read_excel(&quot;./data/pops/cc/200812_201012_연령별인구현황_연간.xlsx&quot;)</code></pre>
<p>Excel은 기본적으로 데이터와 다른 객체(설명, 그래프, 요약 값등)가 분리되지 않아 데이터를 한번 살펴볼 필요가 있다. 다음은 위의 데이터를 다운로드 받아 우선 살펴본 후 다음과 같은 자료의 특성을 파악할 수 있었다.</p>
<ul>
<li>첫줄에 있는 자료는 데이터가 아닌 설명을 담고 있다.</li>
<li>각 열의 제목이 여러 행에 걸쳐 있다.</li>
<li>각 열의 제목이 여러 열을 병합하여 이루고 있다.</li>
<li>3열부터는 각 년도별, 분류별(계, 남, 여)로 5세 단위 인구로 되어 있다.
<ul>
<li>각 년도별 구분별 인구에는 앞 부분에 합에 해당하는 두 개의 인구수가 있다.</li>
</ul></li>
<li>실제 데이터는 5행 부터 시작된다. (변수명 포함시 4행부터)</li>
</ul>
<pre class="r"><code>dat1</code></pre>
<pre><code>## # A tibble: 6 x 209
##   `※ 매년 말일자 통계 현황~ ...2  ...3  ...4  ...5  ...6  ...7  ...8  ...9  ...10 ...11
##   &lt;chr&gt;            &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
## 1 &lt;NA&gt;             &lt;NA&gt;  2008~ &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
## 2 &lt;NA&gt;             &lt;NA&gt;  계    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
## 3 행정기관코드     행정기관~ 총 인구~ 연령구간~ 0~4세 5~9세 10~1~ 15~1~ 20~2~ 25~2~ 30~3~
## 4 4211000000       강원도 ~ 2619~ 2619~ 11381 15326 18927 18260 17214 19038 17812
## 5 4211025000       강원도 ~ 7531  7531  264   289   353   433   459   481   462  
## 6 4211031000       강원도 ~ 6025  6025  284   331   333   375   376   381   372  
## # ... with 198 more variables: ...12 &lt;chr&gt;, ...13 &lt;chr&gt;, ...14 &lt;chr&gt;,
## #   ...15 &lt;chr&gt;, ...16 &lt;chr&gt;, ...17 &lt;chr&gt;, ...18 &lt;chr&gt;, ...19 &lt;chr&gt;,
## #   ...20 &lt;chr&gt;, ...21 &lt;chr&gt;, ...22 &lt;chr&gt;, ...23 &lt;chr&gt;, ...24 &lt;chr&gt;,
## #   ...25 &lt;chr&gt;, ...26 &lt;chr&gt;, ...27 &lt;chr&gt;, ...28 &lt;chr&gt;, ...29 &lt;chr&gt;,
## #   ...30 &lt;chr&gt;, ...31 &lt;chr&gt;, ...32 &lt;chr&gt;, ...33 &lt;chr&gt;, ...34 &lt;chr&gt;,
## #   ...35 &lt;chr&gt;, ...36 &lt;chr&gt;, ...37 &lt;chr&gt;, ...38 &lt;chr&gt;, ...39 &lt;chr&gt;,
## #   ...40 &lt;chr&gt;, ...41 &lt;chr&gt;, ...42 &lt;chr&gt;, ...43 &lt;chr&gt;, ...44 &lt;chr&gt;,
## #   ...45 &lt;chr&gt;, ...46 &lt;chr&gt;, ...47 &lt;chr&gt;, ...48 &lt;chr&gt;, ...49 &lt;chr&gt;,
## #   ...50 &lt;chr&gt;, ...51 &lt;chr&gt;, ...52 &lt;chr&gt;, ...53 &lt;chr&gt;, ...54 &lt;chr&gt;,
## #   ...55 &lt;chr&gt;, ...56 &lt;chr&gt;, ...57 &lt;chr&gt;, ...58 &lt;chr&gt;, ...59 &lt;chr&gt;,
## #   ...60 &lt;chr&gt;, ...61 &lt;chr&gt;, ...62 &lt;chr&gt;, ...63 &lt;chr&gt;, ...64 &lt;chr&gt;,
## #   ...65 &lt;chr&gt;, ...66 &lt;chr&gt;, ...67 &lt;chr&gt;, ...68 &lt;chr&gt;, ...69 &lt;chr&gt;,
## #   ...70 &lt;chr&gt;, ...71 &lt;chr&gt;, ...72 &lt;chr&gt;, ...73 &lt;chr&gt;, ...74 &lt;chr&gt;,
## #   ...75 &lt;chr&gt;, ...76 &lt;chr&gt;, ...77 &lt;chr&gt;, ...78 &lt;chr&gt;, ...79 &lt;chr&gt;,
## #   ...80 &lt;chr&gt;, ...81 &lt;chr&gt;, ...82 &lt;chr&gt;, ...83 &lt;chr&gt;, ...84 &lt;chr&gt;,
## #   ...85 &lt;chr&gt;, ...86 &lt;chr&gt;, ...87 &lt;chr&gt;, ...88 &lt;chr&gt;, ...89 &lt;chr&gt;,
## #   ...90 &lt;chr&gt;, ...91 &lt;chr&gt;, ...92 &lt;chr&gt;, ...93 &lt;chr&gt;, ...94 &lt;chr&gt;,
## #   ...95 &lt;chr&gt;, ...96 &lt;chr&gt;, ...97 &lt;chr&gt;, ...98 &lt;chr&gt;, ...99 &lt;chr&gt;,
## #   ...100 &lt;chr&gt;, ...101 &lt;chr&gt;, ...102 &lt;chr&gt;, ...103 &lt;chr&gt;, ...104 &lt;chr&gt;,
## #   ...105 &lt;chr&gt;, ...106 &lt;chr&gt;, ...107 &lt;chr&gt;, ...108 &lt;chr&gt;, ...109 &lt;chr&gt;,
## #   ...110 &lt;chr&gt;, ...111 &lt;chr&gt;, ...</code></pre>
</div>
<div id="열-이름-재지정하기" class="section level3">
<h3>열 이름 재지정하기</h3>
<p>위에서 읽어온 자료의 경우 Excel 파일의 첫번째 행의 값을 변수명으로 판단하고 있으며, 두번째 행부터 자료로 읽어왔다. 이렇게 읽어온 자료는 변수 <code>dat1</code>에 tibble 형태로 저장되어 있으며, 이 자료 중 첫번째 행은 년도 정보를 갖고 있다.</p>
<ul>
<li><code>paste()</code> 함수를 이용하여 첫번째 행의 각 데이터를 문자열 데이터로 만들어 확인하면 다음과 같다.</li>
</ul>
<pre class="r"><code>paste( dat1[1, ] )</code></pre>
<pre><code>##   [1] &quot;NA&quot;     &quot;NA&quot;     &quot;2008년&quot; &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;    
##   [9] &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;    
##  [17] &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;    
##  [25] &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;    
##  [33] &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;    
##  [41] &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;    
##  [49] &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;    
##  [57] &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;    
##  [65] &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;2009년&quot;
##  [73] &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;    
##  [81] &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;    
##  [89] &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;    
##  [97] &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;    
## [105] &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;    
## [113] &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;    
## [121] &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;    
## [129] &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;    
## [137] &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;2010년&quot; &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;    
## [145] &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;    
## [153] &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;    
## [161] &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;    
## [169] &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;    
## [177] &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;    
## [185] &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;    
## [193] &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;    
## [201] &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;     &quot;NA&quot;    
## [209] &quot;NA&quot;</code></pre>
<ul>
<li>갖고 있는 값들만으로 만들기 위해 <code>ifelse()</code>를 이용하여 <em>“NA”</em> 를 <code>NA</code>로 만들고 그렇지 않을 경우, 즉 값을 갖고 있으면 기존 값을 그대로 사용</li>
<li>이렇게 만들어지 벡터를 테이블 함수를 이용하여 값 확인</li>
<li>테이블의 열이름이 우리 데이터의 년도 정보</li>
</ul>
<pre class="r"><code>ifelse( paste(dat1[1, ]) == &quot;NA&quot;, NA, paste(dat1[1, ]) )</code></pre>
<pre><code>##   [1] NA       NA       &quot;2008년&quot; NA       NA       NA       NA       NA      
##   [9] NA       NA       NA       NA       NA       NA       NA       NA      
##  [17] NA       NA       NA       NA       NA       NA       NA       NA      
##  [25] NA       NA       NA       NA       NA       NA       NA       NA      
##  [33] NA       NA       NA       NA       NA       NA       NA       NA      
##  [41] NA       NA       NA       NA       NA       NA       NA       NA      
##  [49] NA       NA       NA       NA       NA       NA       NA       NA      
##  [57] NA       NA       NA       NA       NA       NA       NA       NA      
##  [65] NA       NA       NA       NA       NA       NA       NA       &quot;2009년&quot;
##  [73] NA       NA       NA       NA       NA       NA       NA       NA      
##  [81] NA       NA       NA       NA       NA       NA       NA       NA      
##  [89] NA       NA       NA       NA       NA       NA       NA       NA      
##  [97] NA       NA       NA       NA       NA       NA       NA       NA      
## [105] NA       NA       NA       NA       NA       NA       NA       NA      
## [113] NA       NA       NA       NA       NA       NA       NA       NA      
## [121] NA       NA       NA       NA       NA       NA       NA       NA      
## [129] NA       NA       NA       NA       NA       NA       NA       NA      
## [137] NA       NA       NA       NA       &quot;2010년&quot; NA       NA       NA      
## [145] NA       NA       NA       NA       NA       NA       NA       NA      
## [153] NA       NA       NA       NA       NA       NA       NA       NA      
## [161] NA       NA       NA       NA       NA       NA       NA       NA      
## [169] NA       NA       NA       NA       NA       NA       NA       NA      
## [177] NA       NA       NA       NA       NA       NA       NA       NA      
## [185] NA       NA       NA       NA       NA       NA       NA       NA      
## [193] NA       NA       NA       NA       NA       NA       NA       NA      
## [201] NA       NA       NA       NA       NA       NA       NA       NA      
## [209] NA</code></pre>
<pre class="r"><code>table( ifelse( paste( dat1[1, ] ) == &quot;NA&quot;, NA, paste(dat1[1, ]) ) )</code></pre>
<pre><code>## 
## 2008년 2009년 2010년 
##      1      1      1</code></pre>
<pre class="r"><code>names( table( ifelse( paste( dat1[1, ] ) == &quot;NA&quot;, NA, paste(dat1[1, ]) ) ) )</code></pre>
<pre><code>## [1] &quot;2008년&quot; &quot;2009년&quot; &quot;2010년&quot;</code></pre>
<p>이제 본 자료는 2008년, 2009년, 2010년와 같은 년도 자료를 갖고 있음을 확인할 수 있다.</p>
<p>다음으로 위의 자료에서 두번째 행이 갖고 있는 정보는 어떤 분류를 갖고 있는지에 대한 것으로 위와 마찬가지로 그 값을 확인해 보자</p>
<pre class="r"><code>paste(dat1[2, ])</code></pre>
<pre><code>##   [1] &quot;NA&quot; &quot;NA&quot; &quot;계&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot;
##  [16] &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;남&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot;
##  [31] &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot;
##  [46] &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;여&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot;
##  [61] &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;계&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot;
##  [76] &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot;
##  [91] &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;남&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot;
## [106] &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;여&quot; &quot;NA&quot; &quot;NA&quot;
## [121] &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot;
## [136] &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;계&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot;
## [151] &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;남&quot; &quot;NA&quot;
## [166] &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot;
## [181] &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;여&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot;
## [196] &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot;</code></pre>
<pre class="r"><code>ifelse( paste(dat1[2, ]) == &quot;NA&quot;, NA, paste(dat1[2, ]) )</code></pre>
<pre><code>##   [1] NA   NA   &quot;계&quot; NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA  
##  [16] NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   &quot;남&quot; NA   NA   NA   NA  
##  [31] NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA  
##  [46] NA   NA   NA   &quot;여&quot; NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA  
##  [61] NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   &quot;계&quot; NA   NA   NA  
##  [76] NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA  
##  [91] NA   NA   NA   NA   &quot;남&quot; NA   NA   NA   NA   NA   NA   NA   NA   NA   NA  
## [106] NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   &quot;여&quot; NA   NA  
## [121] NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA  
## [136] NA   NA   NA   NA   NA   &quot;계&quot; NA   NA   NA   NA   NA   NA   NA   NA   NA  
## [151] NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   &quot;남&quot; NA  
## [166] NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA  
## [181] NA   NA   NA   NA   NA   NA   &quot;여&quot; NA   NA   NA   NA   NA   NA   NA   NA  
## [196] NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA</code></pre>
<pre class="r"><code>table( ifelse( paste( dat1[2, ] ) == &quot;NA&quot;, NA, paste(dat1[2, ]) ) )</code></pre>
<pre><code>## 
## 계 남 여 
##  3  3  3</code></pre>
<pre class="r"><code>names( table( ifelse( paste( dat1[2, ] ) == &quot;NA&quot;, NA, paste(dat1[2, ]) ) ) )</code></pre>
<pre><code>## [1] &quot;계&quot; &quot;남&quot; &quot;여&quot;</code></pre>
<p>마지막으로 각 열이 갖고 있는 열 이름(5세 단위 구분)은 다음과 같이 확인할 수 있다.</p>
<pre class="r"><code>paste(dat1[3, -(1:2)])</code></pre>
<pre><code>##   [1] &quot;총 인구수&quot;      &quot;연령구간인구수&quot; &quot;0~4세&quot;          &quot;5~9세&quot;         
##   [5] &quot;10~14세&quot;        &quot;15~19세&quot;        &quot;20~24세&quot;        &quot;25~29세&quot;       
##   [9] &quot;30~34세&quot;        &quot;35~39세&quot;        &quot;40~44세&quot;        &quot;45~49세&quot;       
##  [13] &quot;50~54세&quot;        &quot;55~59세&quot;        &quot;60~64세&quot;        &quot;65~69세&quot;       
##  [17] &quot;70~74세&quot;        &quot;75~79세&quot;        &quot;80~84세&quot;        &quot;85~89세&quot;       
##  [21] &quot;90~94세&quot;        &quot;95~99세&quot;        &quot;100세 이상&quot;     &quot;남 인구수&quot;     
##  [25] &quot;연령구간인구수&quot; &quot;0~4세&quot;          &quot;5~9세&quot;          &quot;10~14세&quot;       
##  [29] &quot;15~19세&quot;        &quot;20~24세&quot;        &quot;25~29세&quot;        &quot;30~34세&quot;       
##  [33] &quot;35~39세&quot;        &quot;40~44세&quot;        &quot;45~49세&quot;        &quot;50~54세&quot;       
##  [37] &quot;55~59세&quot;        &quot;60~64세&quot;        &quot;65~69세&quot;        &quot;70~74세&quot;       
##  [41] &quot;75~79세&quot;        &quot;80~84세&quot;        &quot;85~89세&quot;        &quot;90~94세&quot;       
##  [45] &quot;95~99세&quot;        &quot;100세 이상&quot;     &quot;여 인구수&quot;      &quot;연령구간인구수&quot;
##  [49] &quot;0~4세&quot;          &quot;5~9세&quot;          &quot;10~14세&quot;        &quot;15~19세&quot;       
##  [53] &quot;20~24세&quot;        &quot;25~29세&quot;        &quot;30~34세&quot;        &quot;35~39세&quot;       
##  [57] &quot;40~44세&quot;        &quot;45~49세&quot;        &quot;50~54세&quot;        &quot;55~59세&quot;       
##  [61] &quot;60~64세&quot;        &quot;65~69세&quot;        &quot;70~74세&quot;        &quot;75~79세&quot;       
##  [65] &quot;80~84세&quot;        &quot;85~89세&quot;        &quot;90~94세&quot;        &quot;95~99세&quot;       
##  [69] &quot;100세 이상&quot;     &quot;총 인구수&quot;      &quot;연령구간인구수&quot; &quot;0~4세&quot;         
##  [73] &quot;5~9세&quot;          &quot;10~14세&quot;        &quot;15~19세&quot;        &quot;20~24세&quot;       
##  [77] &quot;25~29세&quot;        &quot;30~34세&quot;        &quot;35~39세&quot;        &quot;40~44세&quot;       
##  [81] &quot;45~49세&quot;        &quot;50~54세&quot;        &quot;55~59세&quot;        &quot;60~64세&quot;       
##  [85] &quot;65~69세&quot;        &quot;70~74세&quot;        &quot;75~79세&quot;        &quot;80~84세&quot;       
##  [89] &quot;85~89세&quot;        &quot;90~94세&quot;        &quot;95~99세&quot;        &quot;100세 이상&quot;    
##  [93] &quot;총 인구수&quot;      &quot;연령구간인구수&quot; &quot;0~4세&quot;          &quot;5~9세&quot;         
##  [97] &quot;10~14세&quot;        &quot;15~19세&quot;        &quot;20~24세&quot;        &quot;25~29세&quot;       
## [101] &quot;30~34세&quot;        &quot;35~39세&quot;        &quot;40~44세&quot;        &quot;45~49세&quot;       
## [105] &quot;50~54세&quot;        &quot;55~59세&quot;        &quot;60~64세&quot;        &quot;65~69세&quot;       
## [109] &quot;70~74세&quot;        &quot;75~79세&quot;        &quot;80~84세&quot;        &quot;85~89세&quot;       
## [113] &quot;90~94세&quot;        &quot;95~99세&quot;        &quot;100세 이상&quot;     &quot;총 인구수&quot;     
## [117] &quot;연령구간인구수&quot; &quot;0~4세&quot;          &quot;5~9세&quot;          &quot;10~14세&quot;       
## [121] &quot;15~19세&quot;        &quot;20~24세&quot;        &quot;25~29세&quot;        &quot;30~34세&quot;       
## [125] &quot;35~39세&quot;        &quot;40~44세&quot;        &quot;45~49세&quot;        &quot;50~54세&quot;       
## [129] &quot;55~59세&quot;        &quot;60~64세&quot;        &quot;65~69세&quot;        &quot;70~74세&quot;       
## [133] &quot;75~79세&quot;        &quot;80~84세&quot;        &quot;85~89세&quot;        &quot;90~94세&quot;       
## [137] &quot;95~99세&quot;        &quot;100세 이상&quot;     &quot;총 인구수&quot;      &quot;연령구간인구수&quot;
## [141] &quot;0~4세&quot;          &quot;5~9세&quot;          &quot;10~14세&quot;        &quot;15~19세&quot;       
## [145] &quot;20~24세&quot;        &quot;25~29세&quot;        &quot;30~34세&quot;        &quot;35~39세&quot;       
## [149] &quot;40~44세&quot;        &quot;45~49세&quot;        &quot;50~54세&quot;        &quot;55~59세&quot;       
## [153] &quot;60~64세&quot;        &quot;65~69세&quot;        &quot;70~74세&quot;        &quot;75~79세&quot;       
## [157] &quot;80~84세&quot;        &quot;85~89세&quot;        &quot;90~94세&quot;        &quot;95~99세&quot;       
## [161] &quot;100세 이상&quot;     &quot;총 인구수&quot;      &quot;연령구간인구수&quot; &quot;0~4세&quot;         
## [165] &quot;5~9세&quot;          &quot;10~14세&quot;        &quot;15~19세&quot;        &quot;20~24세&quot;       
## [169] &quot;25~29세&quot;        &quot;30~34세&quot;        &quot;35~39세&quot;        &quot;40~44세&quot;       
## [173] &quot;45~49세&quot;        &quot;50~54세&quot;        &quot;55~59세&quot;        &quot;60~64세&quot;       
## [177] &quot;65~69세&quot;        &quot;70~74세&quot;        &quot;75~79세&quot;        &quot;80~84세&quot;       
## [181] &quot;85~89세&quot;        &quot;90~94세&quot;        &quot;95~99세&quot;        &quot;100세 이상&quot;    
## [185] &quot;총 인구수&quot;      &quot;연령구간인구수&quot; &quot;0~4세&quot;          &quot;5~9세&quot;         
## [189] &quot;10~14세&quot;        &quot;15~19세&quot;        &quot;20~24세&quot;        &quot;25~29세&quot;       
## [193] &quot;30~34세&quot;        &quot;35~39세&quot;        &quot;40~44세&quot;        &quot;45~49세&quot;       
## [197] &quot;50~54세&quot;        &quot;55~59세&quot;        &quot;60~64세&quot;        &quot;65~69세&quot;       
## [201] &quot;70~74세&quot;        &quot;75~79세&quot;        &quot;80~84세&quot;        &quot;85~89세&quot;       
## [205] &quot;90~94세&quot;        &quot;95~99세&quot;        &quot;100세 이상&quot;</code></pre>
<p>이제 최종적으로 열 이름을 세 개의 행에 걸쳐 새롭게 만들어 보면 다음과 같다.</p>
<ul>
<li>세번째에 있는 연령 단위가 각 열의 이름이고, 그 윗 단계인 성별 구분(계, 남, 여)이 년도별로 들어가야 한다.
<ul>
<li>세번째 행의 연령 단위별 변수명은 그대로 사용한다. (변수 <code>vars</code>에 저장)</li>
</ul></li>
<li>(성별)구분의 반복이 년도별 “계,….,계, 남, …, 남, 여, ….여”가 만들어지도록 하였다. (변수 <code>grps</code>에 저장)
<ul>
<li>우선 기존에 비어 있는 열의 값은 문자열 <code>"NA"</code>이며 이를 결측을 나타내는 <code>NA</code>로 변경한다.</li>
<li><code>read_excel()</code> 함수의 <code>na</code>인수에 “NA”를 넣어 읽어올때 결측값을 지정할 수 있다.</li>
</ul></li>
<li>년도값 또한 성별 구분인 계, 남, 여 별로 연령 구간만큼 존재해야 한다.
<ul>
<li>필요한 년도의 갯수는 아래와 같이 구해 변수 <code>years</code>에 저장</li>
</ul></li>
<li>앞으로 이 세개의 값을 합쳐 변수명으로 사용하고자 한다.
<ul>
<li><code>"년도_구분_연령단위"</code>로 만들어 변수 <code>var_names</code>에 저장하였다.</li>
</ul></li>
</ul>
<pre class="r"><code>years &lt;- names( table( ifelse( paste( dat1[1, ] ) == &quot;NA&quot;, NA, paste(dat1[1, ]) ) ) )
grps &lt;- names( table( ifelse( paste( dat1[2, ] ) == &quot;NA&quot;, NA, paste(dat1[2, ]) ) ) )
vars &lt;- paste(dat1[3, -(1:2)])

length(years)</code></pre>
<pre><code>## [1] 3</code></pre>
<pre class="r"><code>length(grps)</code></pre>
<pre><code>## [1] 3</code></pre>
<pre class="r"><code>length(vars)</code></pre>
<pre><code>## [1] 207</code></pre>
<pre class="r"><code>grps &lt;- rep( rep( grps, each=(length(vars)/length(grps))/length(years) ), length(years) ) 
years &lt;- rep(years, each = length(vars) / length(years))

var_names &lt;- paste(years, grps, vars, sep=&quot;_&quot;)</code></pre>
</div>
<div id="데이터-다시-읽기" class="section level3">
<h3>데이터 다시 읽기</h3>
<p><code>read_excel()</code>함수는 원하는 행 만큼을 건너뛰고 데이터를 읽을 수 있어 다음과 같이 읽을 수 있다.</p>
<ul>
<li>먼저 4행의 데이터를 변수명으로 할 경우
<ul>
<li>3행까지는 읽지 않고 건너뜀 : <code>skip=3</code></li>
</ul></li>
</ul>
<pre class="r"><code>dat &lt;- read_excel(&quot;./data/pops/cc/200812_201012_연령별인구현황_연간.xlsx&quot;, skip=3)</code></pre>
<pre><code>## New names:
## * `총 인구수` -&gt; `총 인구수...3`
## * 연령구간인구수 -&gt; 연령구간인구수...4
## * `0~4세` -&gt; `0~4세...5`
## * `5~9세` -&gt; `5~9세...6`
## * `10~14세` -&gt; `10~14세...7`
## * ...</code></pre>
<pre class="r"><code>dat</code></pre>
<pre><code>## # A tibble: 26 x 209
##    행정기관코드 행정기관 `총 인구수...3` 연령구간인구수...4~ `0~4세...5`
##    &lt;chr&gt;        &lt;chr&gt;              &lt;dbl&gt;            &lt;dbl&gt;       &lt;dbl&gt;
##  1 4211000000   강원도 춘천시~          261975           261975       11381
##  2 4211025000   강원도 춘천시~            7531             7531         264
##  3 4211031000   강원도 춘천시~            6025             6025         284
##  4 4211032000   강원도 춘천시~            1613             1613          38
##  5 4211033000   강원도 춘천시~            2603             2603          58
##  6 4211034000   강원도 춘천시~            1130             1130          27
##  7 4211035000   강원도 춘천시~            4151             4151         109
##  8 4211036000   강원도 춘천시~            2600             2600          55
##  9 4211038000   강원도 춘천시~             886              886          10
## 10 4211039000   강원도 춘천시~           10585            10585         642
## # ... with 16 more rows, and 204 more variables: `5~9세...6` &lt;dbl&gt;,
## #   `10~14세...7` &lt;dbl&gt;, `15~19세...8` &lt;dbl&gt;, `20~24세...9` &lt;dbl&gt;,
## #   `25~29세...10` &lt;dbl&gt;, `30~34세...11` &lt;dbl&gt;, `35~39세...12` &lt;dbl&gt;,
## #   `40~44세...13` &lt;dbl&gt;, `45~49세...14` &lt;dbl&gt;, `50~54세...15` &lt;dbl&gt;,
## #   `55~59세...16` &lt;dbl&gt;, `60~64세...17` &lt;dbl&gt;, `65~69세...18` &lt;dbl&gt;,
## #   `70~74세...19` &lt;dbl&gt;, `75~79세...20` &lt;dbl&gt;, `80~84세...21` &lt;dbl&gt;,
## #   `85~89세...22` &lt;dbl&gt;, `90~94세...23` &lt;dbl&gt;, `95~99세...24` &lt;dbl&gt;, `100세
## #   이상...25` &lt;dbl&gt;, `남 인구수` &lt;dbl&gt;, 연령구간인구수...27 &lt;dbl&gt;,
## #   `0~4세...28` &lt;dbl&gt;, `5~9세...29` &lt;dbl&gt;, `10~14세...30` &lt;dbl&gt;,
## #   `15~19세...31` &lt;dbl&gt;, `20~24세...32` &lt;dbl&gt;, `25~29세...33` &lt;dbl&gt;,
## #   `30~34세...34` &lt;dbl&gt;, `35~39세...35` &lt;dbl&gt;, `40~44세...36` &lt;dbl&gt;,
## #   `45~49세...37` &lt;dbl&gt;, `50~54세...38` &lt;dbl&gt;, `55~59세...39` &lt;dbl&gt;,
## #   `60~64세...40` &lt;dbl&gt;, `65~69세...41` &lt;dbl&gt;, `70~74세...42` &lt;dbl&gt;,
## #   `75~79세...43` &lt;dbl&gt;, `80~84세...44` &lt;dbl&gt;, `85~89세...45` &lt;dbl&gt;,
## #   `90~94세...46` &lt;dbl&gt;, `95~99세...47` &lt;dbl&gt;, `100세 이상...48` &lt;dbl&gt;, `여
## #   인구수` &lt;dbl&gt;, 연령구간인구수...50 &lt;dbl&gt;, `0~4세...51` &lt;dbl&gt;,
## #   `5~9세...52` &lt;dbl&gt;, `10~14세...53` &lt;dbl&gt;, `15~19세...54` &lt;dbl&gt;,
## #   `20~24세...55` &lt;dbl&gt;, `25~29세...56` &lt;dbl&gt;, `30~34세...57` &lt;dbl&gt;,
## #   `35~39세...58` &lt;dbl&gt;, `40~44세...59` &lt;dbl&gt;, `45~49세...60` &lt;dbl&gt;,
## #   `50~54세...61` &lt;dbl&gt;, `55~59세...62` &lt;dbl&gt;, `60~64세...63` &lt;dbl&gt;,
## #   `65~69세...64` &lt;dbl&gt;, `70~74세...65` &lt;dbl&gt;, `75~79세...66` &lt;dbl&gt;,
## #   `80~84세...67` &lt;dbl&gt;, `85~89세...68` &lt;dbl&gt;, `90~94세...69` &lt;dbl&gt;,
## #   `95~99세...70` &lt;dbl&gt;, `100세 이상...71` &lt;dbl&gt;, `총 인구수...72` &lt;dbl&gt;,
## #   연령구간인구수...73 &lt;dbl&gt;, `0~4세...74` &lt;dbl&gt;, `5~9세...75` &lt;dbl&gt;,
## #   `10~14세...76` &lt;dbl&gt;, `15~19세...77` &lt;dbl&gt;, `20~24세...78` &lt;dbl&gt;,
## #   `25~29세...79` &lt;dbl&gt;, `30~34세...80` &lt;dbl&gt;, `35~39세...81` &lt;dbl&gt;,
## #   `40~44세...82` &lt;dbl&gt;, `45~49세...83` &lt;dbl&gt;, `50~54세...84` &lt;dbl&gt;,
## #   `55~59세...85` &lt;dbl&gt;, `60~64세...86` &lt;dbl&gt;, `65~69세...87` &lt;dbl&gt;,
## #   `70~74세...88` &lt;dbl&gt;, `75~79세...89` &lt;dbl&gt;, `80~84세...90` &lt;dbl&gt;,
## #   `85~89세...91` &lt;dbl&gt;, `90~94세...92` &lt;dbl&gt;, `95~99세...93` &lt;dbl&gt;, `100세
## #   이상...94` &lt;dbl&gt;, `총 인구수...95` &lt;dbl&gt;, 연령구간인구수...96 &lt;dbl&gt;,
## #   `0~4세...97` &lt;dbl&gt;, `5~9세...98` &lt;dbl&gt;, `10~14세...99` &lt;dbl&gt;,
## #   `15~19세...100` &lt;dbl&gt;, `20~24세...101` &lt;dbl&gt;, `25~29세...102` &lt;dbl&gt;,
## #   `30~34세...103` &lt;dbl&gt;, `35~39세...104` &lt;dbl&gt;, `40~44세...105` &lt;dbl&gt;, ...</code></pre>
<ul>
<li>만일 변수명을 데이터로부터 읽지 않으려면 다음과 같이 한다.
<ul>
<li>4행까지 건너뛰고 : <code>skip=4</code></li>
<li>변수명 읽는 행 없이 바로 데이터로 읽기 : <code>col_names=FALSE</code></li>
</ul></li>
</ul>
<pre class="r"><code>dat &lt;- read_excel(&quot;./data/pops/cc/200812_201012_연령별인구현황_연간.xlsx&quot;, skip=4, col_names=FALSE)</code></pre>
<pre><code>## New names:
## * `` -&gt; ...1
## * `` -&gt; ...2
## * `` -&gt; ...3
## * `` -&gt; ...4
## * `` -&gt; ...5
## * ...</code></pre>
<pre class="r"><code>dat</code></pre>
<pre><code>## # A tibble: 26 x 209
##    ...1  ...2    ...3   ...4  ...5  ...6  ...7  ...8  ...9 ...10 ...11 ...12
##    &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 4211~ 강원도 ~ 261975 261975 11381 15326 18927 18260 17214 19038 17812 22623
##  2 4211~ 강원도 ~   7531   7531   264   289   353   433   459   481   462   500
##  3 4211~ 강원도 ~   6025   6025   284   331   333   375   376   381   372   483
##  4 4211~ 강원도 ~   1613   1613    38    48    58    74   110    87    55    80
##  5 4211~ 강원도 ~   2603   2603    58    76   135   163   193   158   112   156
##  6 4211~ 강원도 ~   1130   1130    27    22    25    38    53    61    43    53
##  7 4211~ 강원도 ~   4151   4151   109   127   155   229   219   216   173   193
##  8 4211~ 강원도 ~   2600   2600    55    90   117   146   148   128    85   129
##  9 4211~ 강원도 ~    886    886    10    14    26    50    35    27    25    38
## 10 4211~ 강원도 ~  10585  10585   642   670   714   620   589   788   882  1018
## # ... with 16 more rows, and 197 more variables: ...13 &lt;dbl&gt;, ...14 &lt;dbl&gt;,
## #   ...15 &lt;dbl&gt;, ...16 &lt;dbl&gt;, ...17 &lt;dbl&gt;, ...18 &lt;dbl&gt;, ...19 &lt;dbl&gt;,
## #   ...20 &lt;dbl&gt;, ...21 &lt;dbl&gt;, ...22 &lt;dbl&gt;, ...23 &lt;dbl&gt;, ...24 &lt;dbl&gt;,
## #   ...25 &lt;dbl&gt;, ...26 &lt;dbl&gt;, ...27 &lt;dbl&gt;, ...28 &lt;dbl&gt;, ...29 &lt;dbl&gt;,
## #   ...30 &lt;dbl&gt;, ...31 &lt;dbl&gt;, ...32 &lt;dbl&gt;, ...33 &lt;dbl&gt;, ...34 &lt;dbl&gt;,
## #   ...35 &lt;dbl&gt;, ...36 &lt;dbl&gt;, ...37 &lt;dbl&gt;, ...38 &lt;dbl&gt;, ...39 &lt;dbl&gt;,
## #   ...40 &lt;dbl&gt;, ...41 &lt;dbl&gt;, ...42 &lt;dbl&gt;, ...43 &lt;dbl&gt;, ...44 &lt;dbl&gt;,
## #   ...45 &lt;dbl&gt;, ...46 &lt;dbl&gt;, ...47 &lt;dbl&gt;, ...48 &lt;dbl&gt;, ...49 &lt;dbl&gt;,
## #   ...50 &lt;dbl&gt;, ...51 &lt;dbl&gt;, ...52 &lt;dbl&gt;, ...53 &lt;dbl&gt;, ...54 &lt;dbl&gt;,
## #   ...55 &lt;dbl&gt;, ...56 &lt;dbl&gt;, ...57 &lt;dbl&gt;, ...58 &lt;dbl&gt;, ...59 &lt;dbl&gt;,
## #   ...60 &lt;dbl&gt;, ...61 &lt;dbl&gt;, ...62 &lt;dbl&gt;, ...63 &lt;dbl&gt;, ...64 &lt;dbl&gt;,
## #   ...65 &lt;dbl&gt;, ...66 &lt;dbl&gt;, ...67 &lt;dbl&gt;, ...68 &lt;dbl&gt;, ...69 &lt;dbl&gt;,
## #   ...70 &lt;dbl&gt;, ...71 &lt;dbl&gt;, ...72 &lt;dbl&gt;, ...73 &lt;dbl&gt;, ...74 &lt;dbl&gt;,
## #   ...75 &lt;dbl&gt;, ...76 &lt;dbl&gt;, ...77 &lt;dbl&gt;, ...78 &lt;dbl&gt;, ...79 &lt;dbl&gt;,
## #   ...80 &lt;dbl&gt;, ...81 &lt;dbl&gt;, ...82 &lt;dbl&gt;, ...83 &lt;dbl&gt;, ...84 &lt;dbl&gt;,
## #   ...85 &lt;dbl&gt;, ...86 &lt;dbl&gt;, ...87 &lt;dbl&gt;, ...88 &lt;dbl&gt;, ...89 &lt;dbl&gt;,
## #   ...90 &lt;dbl&gt;, ...91 &lt;dbl&gt;, ...92 &lt;dbl&gt;, ...93 &lt;dbl&gt;, ...94 &lt;dbl&gt;,
## #   ...95 &lt;dbl&gt;, ...96 &lt;dbl&gt;, ...97 &lt;dbl&gt;, ...98 &lt;dbl&gt;, ...99 &lt;dbl&gt;,
## #   ...100 &lt;dbl&gt;, ...101 &lt;dbl&gt;, ...102 &lt;dbl&gt;, ...103 &lt;dbl&gt;, ...104 &lt;dbl&gt;,
## #   ...105 &lt;dbl&gt;, ...106 &lt;dbl&gt;, ...107 &lt;dbl&gt;, ...108 &lt;dbl&gt;, ...109 &lt;dbl&gt;,
## #   ...110 &lt;dbl&gt;, ...111 &lt;dbl&gt;, ...112 &lt;dbl&gt;, ...</code></pre>
</div>
<div id="변수명-재정의하기" class="section level3">
<h3>변수명 재정의하기</h3>
<p>앞서 만든 변수명은 처음 두 열의 이름(행정기관 코드와 읍면동 이름)이 빠져 있어 다음과 같이 두 열의 이름을 추가하여 정의해 준다.</p>
<pre class="r"><code>names( dat ) &lt;- c( &quot;code&quot;, &quot;region&quot;, var_names )
names( dat )</code></pre>
<pre><code>##   [1] &quot;code&quot;                     &quot;region&quot;                  
##   [3] &quot;2008년_계_총 인구수&quot;      &quot;2008년_계_연령구간인구수&quot;
##   [5] &quot;2008년_계_0~4세&quot;          &quot;2008년_계_5~9세&quot;         
##   [7] &quot;2008년_계_10~14세&quot;        &quot;2008년_계_15~19세&quot;       
##   [9] &quot;2008년_계_20~24세&quot;        &quot;2008년_계_25~29세&quot;       
##  [11] &quot;2008년_계_30~34세&quot;        &quot;2008년_계_35~39세&quot;       
##  [13] &quot;2008년_계_40~44세&quot;        &quot;2008년_계_45~49세&quot;       
##  [15] &quot;2008년_계_50~54세&quot;        &quot;2008년_계_55~59세&quot;       
##  [17] &quot;2008년_계_60~64세&quot;        &quot;2008년_계_65~69세&quot;       
##  [19] &quot;2008년_계_70~74세&quot;        &quot;2008년_계_75~79세&quot;       
##  [21] &quot;2008년_계_80~84세&quot;        &quot;2008년_계_85~89세&quot;       
##  [23] &quot;2008년_계_90~94세&quot;        &quot;2008년_계_95~99세&quot;       
##  [25] &quot;2008년_계_100세 이상&quot;     &quot;2008년_남_남 인구수&quot;     
##  [27] &quot;2008년_남_연령구간인구수&quot; &quot;2008년_남_0~4세&quot;         
##  [29] &quot;2008년_남_5~9세&quot;          &quot;2008년_남_10~14세&quot;       
##  [31] &quot;2008년_남_15~19세&quot;        &quot;2008년_남_20~24세&quot;       
##  [33] &quot;2008년_남_25~29세&quot;        &quot;2008년_남_30~34세&quot;       
##  [35] &quot;2008년_남_35~39세&quot;        &quot;2008년_남_40~44세&quot;       
##  [37] &quot;2008년_남_45~49세&quot;        &quot;2008년_남_50~54세&quot;       
##  [39] &quot;2008년_남_55~59세&quot;        &quot;2008년_남_60~64세&quot;       
##  [41] &quot;2008년_남_65~69세&quot;        &quot;2008년_남_70~74세&quot;       
##  [43] &quot;2008년_남_75~79세&quot;        &quot;2008년_남_80~84세&quot;       
##  [45] &quot;2008년_남_85~89세&quot;        &quot;2008년_남_90~94세&quot;       
##  [47] &quot;2008년_남_95~99세&quot;        &quot;2008년_남_100세 이상&quot;    
##  [49] &quot;2008년_여_여 인구수&quot;      &quot;2008년_여_연령구간인구수&quot;
##  [51] &quot;2008년_여_0~4세&quot;          &quot;2008년_여_5~9세&quot;         
##  [53] &quot;2008년_여_10~14세&quot;        &quot;2008년_여_15~19세&quot;       
##  [55] &quot;2008년_여_20~24세&quot;        &quot;2008년_여_25~29세&quot;       
##  [57] &quot;2008년_여_30~34세&quot;        &quot;2008년_여_35~39세&quot;       
##  [59] &quot;2008년_여_40~44세&quot;        &quot;2008년_여_45~49세&quot;       
##  [61] &quot;2008년_여_50~54세&quot;        &quot;2008년_여_55~59세&quot;       
##  [63] &quot;2008년_여_60~64세&quot;        &quot;2008년_여_65~69세&quot;       
##  [65] &quot;2008년_여_70~74세&quot;        &quot;2008년_여_75~79세&quot;       
##  [67] &quot;2008년_여_80~84세&quot;        &quot;2008년_여_85~89세&quot;       
##  [69] &quot;2008년_여_90~94세&quot;        &quot;2008년_여_95~99세&quot;       
##  [71] &quot;2008년_여_100세 이상&quot;     &quot;2009년_계_총 인구수&quot;     
##  [73] &quot;2009년_계_연령구간인구수&quot; &quot;2009년_계_0~4세&quot;         
##  [75] &quot;2009년_계_5~9세&quot;          &quot;2009년_계_10~14세&quot;       
##  [77] &quot;2009년_계_15~19세&quot;        &quot;2009년_계_20~24세&quot;       
##  [79] &quot;2009년_계_25~29세&quot;        &quot;2009년_계_30~34세&quot;       
##  [81] &quot;2009년_계_35~39세&quot;        &quot;2009년_계_40~44세&quot;       
##  [83] &quot;2009년_계_45~49세&quot;        &quot;2009년_계_50~54세&quot;       
##  [85] &quot;2009년_계_55~59세&quot;        &quot;2009년_계_60~64세&quot;       
##  [87] &quot;2009년_계_65~69세&quot;        &quot;2009년_계_70~74세&quot;       
##  [89] &quot;2009년_계_75~79세&quot;        &quot;2009년_계_80~84세&quot;       
##  [91] &quot;2009년_계_85~89세&quot;        &quot;2009년_계_90~94세&quot;       
##  [93] &quot;2009년_계_95~99세&quot;        &quot;2009년_계_100세 이상&quot;    
##  [95] &quot;2009년_남_총 인구수&quot;      &quot;2009년_남_연령구간인구수&quot;
##  [97] &quot;2009년_남_0~4세&quot;          &quot;2009년_남_5~9세&quot;         
##  [99] &quot;2009년_남_10~14세&quot;        &quot;2009년_남_15~19세&quot;       
## [101] &quot;2009년_남_20~24세&quot;        &quot;2009년_남_25~29세&quot;       
## [103] &quot;2009년_남_30~34세&quot;        &quot;2009년_남_35~39세&quot;       
## [105] &quot;2009년_남_40~44세&quot;        &quot;2009년_남_45~49세&quot;       
## [107] &quot;2009년_남_50~54세&quot;        &quot;2009년_남_55~59세&quot;       
## [109] &quot;2009년_남_60~64세&quot;        &quot;2009년_남_65~69세&quot;       
## [111] &quot;2009년_남_70~74세&quot;        &quot;2009년_남_75~79세&quot;       
## [113] &quot;2009년_남_80~84세&quot;        &quot;2009년_남_85~89세&quot;       
## [115] &quot;2009년_남_90~94세&quot;        &quot;2009년_남_95~99세&quot;       
## [117] &quot;2009년_남_100세 이상&quot;     &quot;2009년_여_총 인구수&quot;     
## [119] &quot;2009년_여_연령구간인구수&quot; &quot;2009년_여_0~4세&quot;         
## [121] &quot;2009년_여_5~9세&quot;          &quot;2009년_여_10~14세&quot;       
## [123] &quot;2009년_여_15~19세&quot;        &quot;2009년_여_20~24세&quot;       
## [125] &quot;2009년_여_25~29세&quot;        &quot;2009년_여_30~34세&quot;       
## [127] &quot;2009년_여_35~39세&quot;        &quot;2009년_여_40~44세&quot;       
## [129] &quot;2009년_여_45~49세&quot;        &quot;2009년_여_50~54세&quot;       
## [131] &quot;2009년_여_55~59세&quot;        &quot;2009년_여_60~64세&quot;       
## [133] &quot;2009년_여_65~69세&quot;        &quot;2009년_여_70~74세&quot;       
## [135] &quot;2009년_여_75~79세&quot;        &quot;2009년_여_80~84세&quot;       
## [137] &quot;2009년_여_85~89세&quot;        &quot;2009년_여_90~94세&quot;       
## [139] &quot;2009년_여_95~99세&quot;        &quot;2009년_여_100세 이상&quot;    
## [141] &quot;2010년_계_총 인구수&quot;      &quot;2010년_계_연령구간인구수&quot;
## [143] &quot;2010년_계_0~4세&quot;          &quot;2010년_계_5~9세&quot;         
## [145] &quot;2010년_계_10~14세&quot;        &quot;2010년_계_15~19세&quot;       
## [147] &quot;2010년_계_20~24세&quot;        &quot;2010년_계_25~29세&quot;       
## [149] &quot;2010년_계_30~34세&quot;        &quot;2010년_계_35~39세&quot;       
## [151] &quot;2010년_계_40~44세&quot;        &quot;2010년_계_45~49세&quot;       
## [153] &quot;2010년_계_50~54세&quot;        &quot;2010년_계_55~59세&quot;       
## [155] &quot;2010년_계_60~64세&quot;        &quot;2010년_계_65~69세&quot;       
## [157] &quot;2010년_계_70~74세&quot;        &quot;2010년_계_75~79세&quot;       
## [159] &quot;2010년_계_80~84세&quot;        &quot;2010년_계_85~89세&quot;       
## [161] &quot;2010년_계_90~94세&quot;        &quot;2010년_계_95~99세&quot;       
## [163] &quot;2010년_계_100세 이상&quot;     &quot;2010년_남_총 인구수&quot;     
## [165] &quot;2010년_남_연령구간인구수&quot; &quot;2010년_남_0~4세&quot;         
## [167] &quot;2010년_남_5~9세&quot;          &quot;2010년_남_10~14세&quot;       
## [169] &quot;2010년_남_15~19세&quot;        &quot;2010년_남_20~24세&quot;       
## [171] &quot;2010년_남_25~29세&quot;        &quot;2010년_남_30~34세&quot;       
## [173] &quot;2010년_남_35~39세&quot;        &quot;2010년_남_40~44세&quot;       
## [175] &quot;2010년_남_45~49세&quot;        &quot;2010년_남_50~54세&quot;       
## [177] &quot;2010년_남_55~59세&quot;        &quot;2010년_남_60~64세&quot;       
## [179] &quot;2010년_남_65~69세&quot;        &quot;2010년_남_70~74세&quot;       
## [181] &quot;2010년_남_75~79세&quot;        &quot;2010년_남_80~84세&quot;       
## [183] &quot;2010년_남_85~89세&quot;        &quot;2010년_남_90~94세&quot;       
## [185] &quot;2010년_남_95~99세&quot;        &quot;2010년_남_100세 이상&quot;    
## [187] &quot;2010년_여_총 인구수&quot;      &quot;2010년_여_연령구간인구수&quot;
## [189] &quot;2010년_여_0~4세&quot;          &quot;2010년_여_5~9세&quot;         
## [191] &quot;2010년_여_10~14세&quot;        &quot;2010년_여_15~19세&quot;       
## [193] &quot;2010년_여_20~24세&quot;        &quot;2010년_여_25~29세&quot;       
## [195] &quot;2010년_여_30~34세&quot;        &quot;2010년_여_35~39세&quot;       
## [197] &quot;2010년_여_40~44세&quot;        &quot;2010년_여_45~49세&quot;       
## [199] &quot;2010년_여_50~54세&quot;        &quot;2010년_여_55~59세&quot;       
## [201] &quot;2010년_여_60~64세&quot;        &quot;2010년_여_65~69세&quot;       
## [203] &quot;2010년_여_70~74세&quot;        &quot;2010년_여_75~79세&quot;       
## [205] &quot;2010년_여_80~84세&quot;        &quot;2010년_여_85~89세&quot;       
## [207] &quot;2010년_여_90~94세&quot;        &quot;2010년_여_95~99세&quot;       
## [209] &quot;2010년_여_100세 이상&quot;</code></pre>
</div>
</div>
<div id="tidy-데이터로-변환하기기" class="section level2">
<h2>tidy 데이터로 변환하기기</h2>
<div id="wide2long" class="section level3">
<h3>wide2long</h3>
<p><code>tidyverse</code> 패키지 (내의 <code>dplyr</code> 패키지)에서 제공하는 함수 <code>gather()</code>는 wide format 데이터를 long format 데이터로 변환하는 기능을 한다. 이 함수를 이용하여 위의 데이터를 long format 데이터로 변환해 보자.</p>
<pre class="r"><code>dat %&gt;%
  gather(key=&quot;age_grp&quot;, value=&quot;pops&quot;, -(1:2))</code></pre>
<pre><code>## # A tibble: 5,382 x 4
##    code       region               age_grp               pops
##    &lt;chr&gt;      &lt;chr&gt;                &lt;chr&gt;                &lt;dbl&gt;
##  1 4211000000 강원도 춘천시        2008년_계_총 인구수 261975
##  2 4211025000 강원도 춘천시 신북읍 2008년_계_총 인구수   7531
##  3 4211031000 강원도 춘천시 동면   2008년_계_총 인구수   6025
##  4 4211032000 강원도 춘천시 동산면 2008년_계_총 인구수   1613
##  5 4211033000 강원도 춘천시 신동면 2008년_계_총 인구수   2603
##  6 4211034000 강원도 춘천시 남면   2008년_계_총 인구수   1130
##  7 4211035000 강원도 춘천시 서면   2008년_계_총 인구수   4151
##  8 4211036000 강원도 춘천시 사북면 2008년_계_총 인구수   2600
##  9 4211038000 강원도 춘천시 북산면 2008년_계_총 인구수    886
## 10 4211039000 강원도 춘천시 동내면 2008년_계_총 인구수  10585
## # ... with 5,372 more rows</code></pre>
</div>
<div id="필요한-열-생성하기" class="section level3">
<h3>필요한 열 생성하기</h3>
<p>마지막으로 위에서 생성한 <code>age_grp</code>열의 값을 <code>separate()</code> 함수를 이용하여 언더스코어(_)를 분리자로 기존 열의 값을 분리하고 지정한 각 열에 배치하는 것으로 이 과정을 통해 Excel로 저장된 주민등록 데이터를 R에서 읽고 분석에 조금 용이하게 하기 위해 tidy 데이터 유형으로 변경하였다.</p>
<pre class="r"><code>dat %&gt;%
  gather(key=&quot;age_grp&quot;, value=&quot;pops&quot;, -(1:2)) %&gt;%
  separate(age_grp, into=c(&quot;year&quot;, &quot;grp&quot;, &quot;age_grp&quot;), sep=&quot;_&quot;)</code></pre>
<pre><code>## # A tibble: 5,382 x 6
##    code       region               year   grp   age_grp     pops
##    &lt;chr&gt;      &lt;chr&gt;                &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt;
##  1 4211000000 강원도 춘천시        2008년 계    총 인구수 261975
##  2 4211025000 강원도 춘천시 신북읍 2008년 계    총 인구수   7531
##  3 4211031000 강원도 춘천시 동면   2008년 계    총 인구수   6025
##  4 4211032000 강원도 춘천시 동산면 2008년 계    총 인구수   1613
##  5 4211033000 강원도 춘천시 신동면 2008년 계    총 인구수   2603
##  6 4211034000 강원도 춘천시 남면   2008년 계    총 인구수   1130
##  7 4211035000 강원도 춘천시 서면   2008년 계    총 인구수   4151
##  8 4211036000 강원도 춘천시 사북면 2008년 계    총 인구수   2600
##  9 4211038000 강원도 춘천시 북산면 2008년 계    총 인구수    886
## 10 4211039000 강원도 춘천시 동내면 2008년 계    총 인구수  10585
## # ... with 5,372 more rows</code></pre>
</div>
</div>
</article><section class="article labels"><a class="category" href=/categories/r-%ED%99%9C%EC%9A%A9/>R - 활용</a><a class="tag" href=/tags/data-preparation/>data preparation</a><a class="tag" href=/tags/excel%EC%9D%BD%EA%B8%B0/>Excel읽기</a><a class="tag" href=/tags/r/>R</a><a class="tag" href=/tags/tidy/>tidy</a><a class="tag" href=/tags/%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%84%EC%B2%98%EB%A6%AC/>데이터 전처리</a></section></div>
<div class="article bottom"><section class="article navigation"><p><a class="link" href="/post/date_time_in_r/"><span class="iconfont icon-article"></span>R에서 날짜와 시간</a></p></section></div></section><section id="footer"><div class="footer-wrap">
    <p class="copyright">BY-SA under CCL V3</p>
    <p class="powerby"><span>Powered&nbsp;by&nbsp;</span><a href="https://gohugo.io" 
        target="_blank">Hugo</a><span>&nbsp;&amp;&nbsp;</span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank">Notepadium</a></p></div></section></body>

</html>